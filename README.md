# Modelling the effect of vascular architecture on the outcome of cancer therapies

This repository provides code and supporting materials for Chapters 3â€“6 of my DPhil thesis at the University of Oxford. For the simulations in Chapter 2, please use [the repo associated with the publication](https://github.com/vedangnarain/enhanced-perfusion-following-exposure-to-radiotherapy).

## Datasets

The synthetic and biological datasets are organised as below.

### Synthetic Data

- Simulations were generated using [Microvessel Chaste](https://jmsgrogan.github.io/MicrovesselChaste/), an add-on to [Chaste](http://www.cs.ox.ac.uk/chaste/).
- To run the code, follow the installation instructions [here](https://jmsgrogan.github.io/MicrovesselChaste/) but use the `MicrovesselChaste` folder from [this branch](https://github.com/vedangnarain/MicrovesselChaste/tree/Vedang) instead.  
- The results were generated by the script `MicrovesselChaste/test/simulation/flow/TestDPhilThesis.hpp`. Each test can be run by removing the 'x' before its declaration.

### Experimental Data

- Data to reproduce the results in Chapter 6 can be found in the folder `vascular_extraction`. 
- Experiments were conducted by Luca Verger and Zofia Varyova at the Kennedy Institute of Rheumatology (KIR) with the help of the KIR animal facility.

## Analysis

The Python files used to analyse the simulation data and produce figures are organised as below.

### Chapter 3

- The data must be obtained from the authors of the cited studies and placed in the respective folders within  `microfluidics_validation/exp_data`
- The forking microfluidic networks can then be compared using `microfluidics_validation/compare_with_forking_microfluidics_experiment.py`
- The honeycomb microfluidic networks can then be compared using `microfluidics_validation/compare_with_merlo_experiments.py`

### Chapters 4 and 5

- The dataset for the hexagonal networks is generated by `calculate_oxygen_hex_metrics_individual_killing_combine_data.py`
- The dataset for the Voronoi networks is generated by `calculate_oxygen_voronoi_metrics_individual_killing_combine_data.py`
- Predictions for the NF are generated by `chapter_4.ipynb` 
- The grid spacing analysis is conducted by `grid_spacing_analysis_ch4.ipynb` 
- Predictions for the SF and RR are generated by `chapter_5.ipynb` 

### Chapter 6

- Metrics for the experimental networks are generated by `analyse_biological_networks.py`
- Normalisation is investigated in `plot_biological_normalisation.py`